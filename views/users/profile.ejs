<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!--===============================================================================================-->
  <link rel="icon" type="image/png" href="/proddetail/images/icons/favicon.png" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/bootstrap/css/bootstrap.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/fonts/iconic/css/material-design-iconic-font.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/fonts/linearicons-v1.0.0/icon-font.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/animate/animate.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/css-hamburgers/hamburgers.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/animsition/css/animsition.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/select2/select2.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/daterangepicker/daterangepicker.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/slick/slick.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/MagnificPopup/magnific-popup.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/vendor/perfect-scrollbar/perfect-scrollbar.css">
  <link rel="stylesheet" href="path/to/lightbox.css">
  <script src="path/to/lightbox.js"></script>
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="/proddetail/css/util.css">
  <link rel="stylesheet" type="text/css" href="/proddetail/css/main.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.all.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <title>Checkout</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Profile</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body {
      font-family: 'Poppins Medium', Arial, sans-serif;
      background-color: #f5f5f5;
    }

    .main {
      max-width: 100%;
      padding: 20px;
      background-color: #0c0c0b;
      box-shadow: 0 0 10px rgba(19, 17, 17, 0.377);
    }

    .profile {
      max-width: 100%;
      margin: 0 auto;
      text-align: center;
      padding: 20px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      border-radius: 10px;
    }

    .profile img {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      margin-bottom: 20px;
    }

    .profile h2 {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .profile p {
      font-size: 14px;
      /* Updated font size */
      margin-bottom: 10px;
    }

    .profile ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .profile li {
      font-size: 14px;
      /* Updated font size */
      margin-bottom: 5px;
    }

    .profile li strong {
      display: inline-block;
      width: 100px;
      font-weight: bold;
      margin-right: 10px;
    }

    .btn-primary,
    .btn-secondary {
      border-radius: 20px;
      padding: 10px 20px;
      font-size: 16px;
      margin-bottom: 10px;
    }

    .btn-primary {
      background-color: #0f0e0d;
      border-color: #1a1817;
    }

    .btn-primary:hover,
    .btn-primary:focus {
      background-color: #1f1f1f;
      border-color: #100f0f;
    }

    .btn-secondary {
      background-color: #f5f5f5;
      border-color: #f5f5f5;
      color: #555;
    }

    .btn-secondary:hover,
    .btn-secondary:focus {
      background-color: #e9e9e9;
      border-color: #e9e9e9;
      color: #555;
    }

    .card-header {
      background-color: #1f1d1b;
      color: #fff;
      font-weight: bold;
    }

    .address-item {
      background-color: #fff;
      border-radius: 10px;
      margin-bottom: 15px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .address-item .icon {
      font-size: 30px;
      color: #161514;
      margin-bottom: 10px;
    }

    .address-item h6 {
      font-size: 18px;
      margin-bottom: 5px;
    }

    .address-item p {
      font-size: 14px;
      color: #777;
      margin-bottom: 5px;
    }

    .address-item .btn {
      border-radius: 20px;
      font-size: 14px;
      padding: 5px 10px;
      margin-top: 10px;
    }

    .text-success {
      color: #28a745;
    }

    .text-danger {
      color: #dc3545;
    }
  </style>

  <style>
    .user-profile {
  text-align: center;
  margin-bottom: 30px;
}

.profile-picture {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 10px;
}

.profile-name {
  font-size: 24px;
  color: #333;
  margin-bottom: 10px;
}

.profile-details {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

.user-field {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.user-label {
  font-weight: bold;
  margin-right: 10px;
  color: #333;
}

.user-value {
  font-size: 16px;
  color: #777;
}


  </style>
</head>

<body>

  <% if(typeof user !="undefined" ){ %>
    <%-include('userlogged') %>
      <%}else{%>
        <%-include('usernotlogged') %>
          <%}%>





            <br>
            <br>
            <br>
            <div class="container main">
              <div class="profile">
                <div class="container">
                  <div class="row">
                    <div class="col-lg-6 user-profile">
                      <img src="/uploads/a.avif" alt="Profile Picture" class="profile-picture">
                      <h2 class="profile-name"><%= userData.name %></h2>
                      <ul class="profile-details">
                        <li><strong>Email:</strong> <%= userData.email %></li>
                        <li><strong>Phone:</strong> <%= userData.mobile %></li>
                        <li>
                          <div class="user-field">
                            <label for="wallet" class="user-label">Wallet:</label>
                            <span id="wallet-amount" class="user-value">
                              <%= userData.wallet %> â‚¹
                            </span>
                          </div>
                        </li>
                        <li>
                          <div class="user-field">
                            <label for="referral" class="user-label">Referral Code:</label>
                            <span id="referral-code" class="user-value">
                              <%= userData.referral %>
                            </span>
                          </div>
                        </li>
                      </ul>
                    </div>
                    

                    <div class="col-lg-6">
                      <br>
                      <br>
                      <br>
                      <a href="/profileEdit?id=<%= userData._id %>" class="btn btn-primary btn-block">Edit profile</a>
                      <br><br>
                      <a href="/order" class="btn btn-primary btn-block">My Orders</a> <br>
                      <a href="/address" class="btn btn-primary btn-block">Manage Address</a> <br>
                      <a href="/forgotpassword" class="btn btn-primary btn-block">Reset Password</a> <br><br>


                    </div>

                    <div class="container">
                      <div class="card mb-4">
                        <div class="card-header">ADDRESS:</div>
                        <div class="card-body">
                          <% address.forEach(function(item) { %>
                            <div class="address-item">
                              <div class="icon"><i class="fas fa-home"></i></div>
                              <h6>
                                <%= item.delivery_point %>
                              </h6>
                              <p>
                                <%= item.name %> &nbsp &nbsp &nbsp<b>
                                    <%= item.number %>
                                  </b>
                              </p>
                              <p>
                                <%= item.email %>
                              </p>
                              <p>
                                <%= item.city %>, <%= item.state %>
                              </p>
                              <p>
                                <%= item.pincode %>
                              </p>

                              <a class="btn btn-danger" href="/delete-address?id=<%= item._id %>"
                                onclick="return confirm('Are You Sure?')">DELETE</a>
                                <a class="btn btn-success" href="/edit-checkOutAddress?id=<%=item._id%>">Edit</a>
                            </div>

                            <% }) %>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
              <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
              <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>



<script>





  function removeaddress(id) {
    var r = confirm("Are you sure you want to delete this address?");
    if (r == true) {
      window.location.href = "/deleteCheckOutAddress?id=" + id;
    }
  }

  function checkCoupon() {
    var couponcode = document.getElementById("couponcode").value;
    var subtotal = document.getElementById("subtotal").value;
    var gtotalval = document.getElementById("gtotalval");

    if (couponcode.trim() !== "") {
      // Make a request to the server to validate the coupon code
      // Example AJAX request using Fetch API
      fetch("/validateCoupon?couponcode=" + couponcode + "&subtotal=" + subtotal)
        .then(function (response) {
          return response.json();
        })
        .then(function (data) {
          if (data.success) {
            gtotalval.value = data.gtotal;
            document.getElementById("offer").innerHTML = data.offer + "%";
            document.getElementById("gtotal").innerHTML = data.gtotal;
            document.getElementById("errorMessage").innerHTML = "";
          } else {
            document.getElementById("errorMessage").innerHTML = data.message;
          }
        })
        .catch(function (error) {
          console.log(error);
        });
    } else {
      document.getElementById("errorMessage").innerHTML = "Please enter a coupon code";
    }
  }
</script>

</body>







<!--===============================================================================================-->
<script src="/proddetail/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/bootstrap/js/popper.js"></script>
<script src="/proddetail/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/select2/select2.min.js"></script>
<script>
  $(".js-select2").each(function () {
    $(this).select2({
      minimumResultsForSearch: 20,
      dropdownParent: $(this).next('.dropDownSelect2')
    });
  })
</script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/daterangepicker/moment.min.js"></script>
<script src="/proddetail/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/slick/slick.min.js"></script>
<script src="/proddetail/js/slick-custom.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/parallax100/parallax100.js"></script>
<script>
  $('.parallax100').parallax100();
</script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
<script>
  $('.gallery-lb').each(function () { // the containers for all your galleries
    $(this).magnificPopup({
      delegate: 'a', // the selector for gallery item
      type: 'image',
      gallery: {
        enabled: true
      },
      mainClass: 'mfp-fade'
    });
  });
</script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/isotope/isotope.pkgd.min.js"></script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/sweetalert/sweetalert.min.js"></script>
<script>
  $('.js-addwish-b2, .js-addwish-detail').on('click', function (e) {
    e.preventDefault();
  });

  $('.js-addwish-b2').each(function () {
    var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
    $(this).on('click', function () {
      swal(nameProduct, "is added to wishlist !", "success");

      $(this).addClass('js-addedwish-b2');
      $(this).off('click');
    });
  });

  $('.js-addwish-detail').each(function () {
    var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();

    $(this).on('click', function () {
      swal(nameProduct, "is added to wishlist !", "success");

      $(this).addClass('js-addedwish-detail');
      $(this).off('click');
    });
  });

  /*---------------------------------------------*/

  $('.js-addcart-detail').each(function () {
    var nameProduct = $(this).parent().parent().parent().parent().find('.js-name-detail').html();
    $(this).on('click', function () {
      swal(nameProduct, "is added to cart !", "success");
    });
  });

</script>
<!--===============================================================================================-->
<script src="/proddetail/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
<script>
  $('.js-pscroll').each(function () {
    $(this).css('position', 'relative');
    $(this).css('overflow', 'hidden');
    var ps = new PerfectScrollbar(this, {
      wheelSpeed: 1,
      scrollingThreshold: 1000,
      wheelPropagation: false,
    });

    $(window).on('resize', function () {
      ps.update();
    })
  });


  const addToCart = async (productId) => {
    console.log("producct id of the fetch00", productId);
    const response = await fetch('/addtocart', {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ productId: productId })
    });
    let res = await response.json();
    if (res == "success") {
      Swal.fire({
        title: 'Success',
        text: "Item added to Cart !",
        icon: 'success',
        showConfirmButton: false,
        iconHtml: '<i class="fas fa-shopping-cart"></i>',
        timer: 1000
      });

    }
  }

  async function addToWishlist(productId) {

    try {
      const response = await fetch('/addToWishlist', {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ productId: productId })
      });

      if (!response.ok) {
        throw new Error('Request failed with status ' + response.status);
      }

      const res = await response.json();

      if (res.status === "success") {
        Swal.fire({
          title: 'Success',
          text: "Item added to Cart!",
          icon: 'success',
          showConfirmButton: false,
          iconHtml: '<i class="fas fa-shopping-cart"></i>',
          timer: 1000
        });
      }
    } catch (error) {
      console.log(error.message);
      // Handle the error gracefully, show an error message to the user, etc.
    }
  }





</script>
<!--===============================================================================================-->
<script src="/proddetail/js/main.js"></script>
<script>




</script>


</html>